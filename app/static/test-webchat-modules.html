<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebChat ëª¨ë“ˆ í…ŒìŠ¤íŠ¸</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .log { background: #f5f5f5; padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
    </style>
</head>
<body>
    <h1>ğŸ¤– MOJI WebChat ëª¨ë“ˆ í…ŒìŠ¤íŠ¸</h1>
    <div id="status">í…ŒìŠ¤íŠ¸ ì‹œì‘ ì¤‘...</div>
    <div id="logs"></div>
    
    <script type="module">
        const statusEl = document.getElementById('status');
        const logsEl = document.getElementById('logs');
        
        function addLog(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `log ${type}`;
            div.textContent = `${new Date().toLocaleTimeString()}: ${message}`;
            logsEl.appendChild(div);
            console.log(message);
        }
        
        async function testModules() {
            try {
                addLog('ğŸ” ëª¨ë“ˆ ë¡œë”© í…ŒìŠ¤íŠ¸ ì‹œì‘', 'info');
                
                // 1. EventEmitter í…ŒìŠ¤íŠ¸
                addLog('ğŸ“¡ EventEmitter ë¡œë”© ì¤‘...', 'info');
                const { EventEmitter } = await import('/static/js/webchat-v2/core/EventEmitter.js');
                addLog('âœ… EventEmitter ë¡œë”© ì„±ê³µ', 'success');
                
                // 2. StateManager í…ŒìŠ¤íŠ¸
                addLog('ğŸ“Š StateManager ë¡œë”© ì¤‘...', 'info');
                const { StateManager, createInitialState } = await import('/static/js/webchat-v2/core/StateManager.js');
                addLog('âœ… StateManager ë¡œë”© ì„±ê³µ', 'success');
                
                // 3. ConfigManager í…ŒìŠ¤íŠ¸
                addLog('âš™ï¸ ConfigManager ë¡œë”© ì¤‘...', 'info');
                const { ConfigManager } = await import('/static/js/webchat-v2/modules/ConfigManager.js');
                addLog('âœ… ConfigManager ë¡œë”© ì„±ê³µ', 'success');
                
                // 4. WebSocketManager í…ŒìŠ¤íŠ¸
                addLog('ğŸŒ WebSocketManager ë¡œë”© ì¤‘...', 'info');
                const { WebSocketManager } = await import('/static/js/webchat-v2/modules/WebSocketManager.js');
                addLog('âœ… WebSocketManager ë¡œë”© ì„±ê³µ', 'success');
                
                // 5. UIRenderer í…ŒìŠ¤íŠ¸
                addLog('ğŸ¨ UIRenderer ë¡œë”© ì¤‘...', 'info');
                const { UIRenderer } = await import('/static/js/webchat-v2/modules/UIRenderer.js');
                addLog('âœ… UIRenderer ë¡œë”© ì„±ê³µ', 'success');
                
                // 6. MessageHandler í…ŒìŠ¤íŠ¸
                addLog('ğŸ’¬ MessageHandler ë¡œë”© ì¤‘...', 'info');
                const { MessageHandler } = await import('/static/js/webchat-v2/modules/MessageHandler.js');
                addLog('âœ… MessageHandler ë¡œë”© ì„±ê³µ', 'success');
                
                // 7. ë©”ì¸ ëª¨ë“ˆ í…ŒìŠ¤íŠ¸
                addLog('ğŸš€ MojiWebChatV2 ë©”ì¸ ëª¨ë“ˆ ë¡œë”© ì¤‘...', 'info');
                const { MojiWebChatV2 } = await import('/static/js/webchat-v2/MojiWebChatV2.js');
                addLog('âœ… MojiWebChatV2 ë©”ì¸ ëª¨ë“ˆ ë¡œë”© ì„±ê³µ', 'success');
                
                // 8. ì¸ìŠ¤í„´ìŠ¤ ìƒì„± í…ŒìŠ¤íŠ¸
                addLog('ğŸ”§ WebChat ì¸ìŠ¤í„´ìŠ¤ ìƒì„± í…ŒìŠ¤íŠ¸...', 'info');
                const config = {
                    wsUrl: `ws://${window.location.host}/api/v1/adapters/webchat/ws`,
                    userId: 'test-user',
                    userName: 'Test User',
                    debug: true
                };
                
                const chat = new MojiWebChatV2(config);
                addLog('âœ… WebChat ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì„±ê³µ', 'success');
                
                statusEl.textContent = 'ğŸ‰ ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼! ëª¨ë“ˆì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤.';
                statusEl.style.color = 'green';
                
                // ì‹¤ì œ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
                setTimeout(() => {
                    addLog('ğŸ”„ ì‹¤ì œ WebChat í˜ì´ì§€ë¡œ ì´ë™ ì¤‘...', 'info');
                    window.location.href = '/api/v1/adapters/webchat/page';
                }, 2000);
                
            } catch (error) {
                addLog(`âŒ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`, 'error');
                statusEl.textContent = 'âŒ ëª¨ë“ˆ ë¡œë”© ì‹¤íŒ¨';
                statusEl.style.color = 'red';
                
                // ê¸°ë³¸ ë²„ì „ìœ¼ë¡œ í´ë°±
                setTimeout(() => {
                    addLog('ğŸ”„ ê¸°ë³¸ WebChat ë²„ì „ìœ¼ë¡œ ì´ë™ ì¤‘...', 'info');
                    window.location.href = '/static/moji-webchat-v2.html';
                }, 3000);
            }
        }
        
        // í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        testModules();
    </script>
</body>
</html> 